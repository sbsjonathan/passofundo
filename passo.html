<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Controle</title>

<style>
:root{
  --bg:#0b1220;
  --card:rgba(255,255,255,.06);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.65);
  --line:rgba(255,255,255,.12);
  --shadow:0 18px 55px rgba(0,0,0,.35);
  --r:18px;
  --pad:14px;
  --accent:#7c4dff;
  --good:#1dd1a1;
  --danger:#ff5d5d;
  --focus:rgba(124,77,255,.45);
}

*{box-sizing:border-box;}

body{
  margin:0;
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,#070b13,#0b1220,#070b13);
  min-height:100vh;
  padding:16px 14px 34px;
}

.wrap{max-width:520px;margin:0 auto;}

h1{font-size:20px;margin:6px 2px 12px;}

.card{
  background:linear-gradient(180deg,var(--card),rgba(255,255,255,.04));
  border:1px solid var(--line);
  border-radius:var(--r);
  box-shadow:var(--shadow);
  overflow:hidden;
}

.toolbar{
  display:flex;
  justify-content:space-between;
  padding:12px var(--pad);
  border-bottom:1px solid var(--line);
}

button{
  border:1px solid var(--line);
  background:rgba(255,255,255,.06);
  color:var(--text);
  padding:10px 12px;
  border-radius:12px;
  font-size:13px;
  font-weight:600;
}

button.primary{
  border-color:rgba(124,77,255,.55);
  background:rgba(124,77,255,.18);
}

button.danger{
  border-color:rgba(255,93,93,.55);
  background:rgba(255,93,93,.14);
}

.scroller{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}

table{
  width:100%;
  border-collapse:collapse;
  min-width:600px;
}

thead th{
  font-size:12px;
  color:var(--muted);
  padding:12px var(--pad);
  border-bottom:1px solid var(--line);
  background:rgba(255,255,255,.03);
}

tbody td{
  padding:10px var(--pad);
  border-bottom:1px solid rgba(255,255,255,.06);
}

.cell-id{
  width:50px;
  color:var(--muted);
  font-weight:700;
}

.input{
  width:100%;
  padding:11px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  color:var(--text);
  outline:none;
  font-size:13px;
  min-height:42px;
}

.input:focus{
  border-color:rgba(124,77,255,.7);
  box-shadow:0 0 0 4px var(--focus);
}

.col-local{min-width:190px;}
.col-tipo{min-width:90px;}
.col-valor{min-width:120px;}
.col-litros{min-width:120px;}

.seg{
  display:inline-flex;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.05);
  border-radius:14px;
  overflow:hidden;
}

.seg button{
  border:none;
  background:transparent;
  padding:10px 14px;
  font-weight:800;
}

.seg button.on{
  background:rgba(124,77,255,.22);
  box-shadow:inset 0 0 0 1px rgba(124,77,255,.45);
}

.litrosSlot.hidden{
  opacity:0;
  pointer-events:none;
}

.cell-actions{
  width:60px;
  text-align:right;
}

.icon-btn{
  min-width:42px;
  min-height:42px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  font-weight:900;
}

.icon-btn.del{
  border-color:rgba(255,93,93,.45);
  background:rgba(255,93,93,.12);
}

.totals{
  padding:12px var(--pad);
  border-top:1px solid var(--line);
  background:rgba(255,255,255,.03);
}

.totalRow{
  display:flex;
  justify-content:space-between;
  font-size:14px;
  font-weight:800;
  margin-bottom:8px;
}
</style>
</head>

<body>
<div class="wrap">
<h1>Controle</h1>

<div class="card">

<div class="toolbar">
  <button class="primary" id="btnAdd">+ Adicionar</button>
  <button class="danger" id="btnReset">Reset</button>
</div>

<div class="scroller">
<table>
<thead>
<tr>
<th>#</th>
<th>Local</th>
<th>P/C</th>
<th>Valor</th>
<th>Litros</th>
<th></th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<div class="totals">
  <div class="totalRow"><span>Total combustível</span><span id="totalComb">R$ 0,00</span></div>
  <div class="totalRow"><span>Total pedágio</span><span id="totalPed">R$ 0,00</span></div>
  <div class="totalRow" style="border-top:1px solid rgba(255,255,255,.12);padding-top:8px;">
    <span>Total geral</span><span id="totalGeral">R$ 0,00</span>
  </div>
</div>

</div>
</div>

<script>
const DEFAULT_ROWS = [
 {local:"Seropedica",tipo:"P",valor:"16,4",litros:""},
 {local:"Itatiaia",tipo:"P",valor:"14,5",litros:""},
 {local:"Guaratinguetá",tipo:"C",valor:"170,31",litros:"37,93"},
 {local:"Pinguamonhang",tipo:"P",valor:"16,9",litros:""},
 {local:"Jacarei",tipo:"P",valor:"8,1",litros:""},
 {local:"Guararema",tipo:"P",valor:"4,5",litros:""},
 {local:"Arujá",tipo:"P",valor:"4,5",litros:""}
];

const STORAGE="controle_gastos_v3";

let rows = JSON.parse(localStorage.getItem(STORAGE)) || DEFAULT_ROWS;

const tbody=document.getElementById("tbody");
const totalComb=document.getElementById("totalComb");
const totalPed=document.getElementById("totalPed");
const totalGeral=document.getElementById("totalGeral");

function save(){localStorage.setItem(STORAGE,JSON.stringify(rows));}

function parseMoney(s){
 if(!s)return 0;
 s=s.replace(",",".");
 return Number(s)||0;
}

function format(n){
 return n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
}

function render(){
 tbody.innerHTML="";
 rows.forEach((r,i)=>{
  const tr=document.createElement("tr");

  tr.innerHTML=`
  <td class="cell-id">${i+1}</td>
  <td class="col-local"><input class="input" value="${r.local}"></td>
  <td class="col-tipo">
    <div class="seg">
      <button class="${r.tipo==="P"?"on":""}">P</button>
      <button class="${r.tipo==="C"?"on":""}">C</button>
    </div>
  </td>
  <td class="col-valor"><input class="input" placeholder="14,40" value="${r.valor||""}"></td>
  <td class="col-litros"><input class="input ${r.tipo==="C"?"":"hidden"}" placeholder="Litros" value="${r.litros||""}"></td>
  <td class="cell-actions"><button class="icon-btn del">✕</button></td>
  `;

  const inputs=tr.querySelectorAll("input");
  inputs[0].oninput=e=>{rows[i].local=e.target.value;save();}
  inputs[1]?.oninput;
  inputs[2].oninput=e=>{rows[i].valor=e.target.value;save();updateTotals();}
  inputs[3]?.oninput=e=>{rows[i].litros=e.target.value;save();}

  const [bP,bC]=tr.querySelectorAll(".seg button");
  bP.onclick=()=>{rows[i].tipo="P";rows[i].litros="";save();render();}
  bC.onclick=()=>{rows[i].tipo="C";save();render();}

  tr.querySelector(".del").onclick=()=>{rows.splice(i,1);save();render();}

  tbody.appendChild(tr);
 });
 updateTotals();
}

function updateTotals(){
 let c=0,p=0;
 rows.forEach(r=>{
  const v=parseMoney(r.valor);
  if(r.tipo==="C")c+=v; else p+=v;
 });
 totalComb.textContent=format(c);
 totalPed.textContent=format(p);
 totalGeral.textContent=format(c+p);
}

document.getElementById("btnAdd").onclick=()=>{
 rows.push({local:"",tipo:"P",valor:"",litros:""});
 save();render();
}

document.getElementById("btnReset").onclick=()=>{
 rows=[...DEFAULT_ROWS];
 save();render();
}

render();
</script>
</body>
</html>